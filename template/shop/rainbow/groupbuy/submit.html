<include file="public/mheader" title="填写订单" body="g4"/>
<include file="public/mheader_nav" title="填写订单" href="javascript:history.go(-1);" back="back"/>
<script src="__PUBLIC__/js/md5.min.js"></script>
<script type="text/javascript" src="__STATIC__/js/date.js"></script>
<script type="text/javascript" src="//api.map.baidu.com/api?ak=iR2qhnXd5vrFI9wUuIRG9AWGIqykVNok&type=lite&v=1.0"></script>
<style type="text/css">
	.bg_time{
		width: 100%;
		height: 100%;
		background-color:rgba(0,0,0,0.4);
		position: absolute;
		top: 0;
		z-index: 999999999;		
	}
	.bg_time img{
		position: absolute;
		left: 50%;
		top: 50%;
		transform: translate(-50%,-50%);

	}
</style>
<div id="wrapBody">
    <!--地址-s-->
    <div class="edit_gtfix shipping_div" id="addressDefault">
        <input type="hidden" class="input_default_address_id" id="input_default_address_id" value="" />
        <input type="hidden" class="hidden-buy-type" id="hidden-buy-type" value="{$info['buy_type']}" />
        <input type="hidden" class="hidden-buy-num" id="hidden-buy-num" value="{$info['buy_num']}" />
        <input type="hidden" class="hidden-team-id" id="hidden-team-id" value="{$info['team_id']}" />
        <if condition="$address">
        <div class="namephone fl" id="address_selected" item="{$address[0]['address_id']}">
            <div class="top">
                <div class="le fl" id="default_address_consignee">{$address[0]['consignee']}</div>
                <div class="lr fl" id="default_address_mobile">{$address[0]['mobile']}</div>
            </div>
            <div class="bot">
                <i class="dwgp"></i>
                <span id="default_address_text">{$region[$address[0]['province']]} {$region[$address[0]['city']]} {$region[$address[0]['district']]} {$address[0]['address']}</span>
            </div>
        </div>
        </if>
        <div class="fr youjter">
            <i class="Mright"></i>
        </div>
        <div class="ttrebu">
            <img src="__STATIC__/images/tt.png"/>
        </div>
    </div>
    <!--商品信息-s-->
    <div class="ord_list fill-orderlist p">
        <div class="maleri30">
            <div class="shopprice">
                <div class="img_or fl"><img src="{$info['original_img']}"/></div>
                <div class="fon_or fl">
                    <h2 class="similar-product-text">{$info['goods_name']}</h2>

                    <!-- <div>商品规格名称</div> -->
                </div>
                <div class="price_or fr">
                    <p class="red"><span>￥</span><span>{$info['price']}</span></p>

                    <p class="ligfill">x{$info['buy_num']}</p>
                </div>
            </div>
        </div>
    </div>
    <!--配送方式 上门自提s-->
    <div class="z-select-wrap shipping_div">
        <div class="z-select-title">
            <div class="maleri30">
                选择配送方式
            </div>
        </div>
        <div class="maleri30 z-dispatching-wrap">
            <div class="p z-dispatching border-none">
                <div class="fl">
                    快速配送
                </div>
                <div class="fr">
                    <label class="dispatching-checkbox" >
                        <div id="express_delivery" class="dispatching-cont z-dispatching-cheng"></div>
                    </label>
                </div>
            </div>
            <div class="z-dispatching-one dispatching-font1" style="display: block;">
                工作日、双休日与节假日均可送货
            </div>
        </div>
    </div>
    <div class="information_dr">
        <div class="maleri30">
            <div class="invoice list7">
                <div class="myorder p">
                    <div class="content30">
                            <div class="order" id="invoiceDefault">
                                <div class="fl">
                                    <span>发票信息</span>
                                    <input type="hidden" name="hidden-invoice-type" id="hidden-invoice-type" value="0" />
                                    <input type="hidden" name="hidden-invoice-identity" id="hidden-invoice-identity" value="0" />
                                    <input type="hidden" name="hidden-invoice-title" id="hidden-invoice-title" value="" />
                                    <input type="hidden" name="hidden-invoice-code" id="hidden-invoice-code" value="" />
                                </div>
                                <div class="fr">
                                    <span class="invoice_title" style="margin-top: 0.6rem;">不开发票</span>
                                    <i class="Mright"></i>
                                </div>
                            </div>
                    </div>
                </div>
            </div>
            <!--使用余额-s-->
            <div class="invoice list7">
                <div class="myorder p">
                    <div class="content30">
                        <a class="remain" href="javascript:void(0);">
                            <div class="order">
                                <div class="fl">
                                    <span>使用余额</span>

                                    <p>余额：￥{$info['user_money']}</p>
                                </div>
                                <div class="fr z-toggle-btn">
                                    <label class="z-toggle z-toggle-royal">
                                        <input type="checkbox" id="user_money" value="{$info['user_money']}"/>

                                        <div class="z-tarck">
                                            <div class="z-handle">
                                            </div>
                                        </div>
                                    </label>
                                </div>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
            <!--使用余额、积分-s-->
            <div id="balance-li" class="invoice list7">

                <div class="myorder myorder-2 p" id="paypwd_view" style="display: none">
                    <div class="content30">
                        <label>
                            <div class="incorise">
                                <span>支付密码：</span>
                                <input type="password" id="pay_pwd" placeholder="请输入支付密码" autocomplete="off"/>
                                <if condition="empty($user['paypwd'])">
                                    <a class="go-set-password" href="{:U('Mobile/User/paypwd')}?redirect_url={$redirect_url}">去设置支付密码?</a>
                                </if>
                            </div>
                        </label>
                    </div>
                </div>
            </div>
            <!--使用余额、积分-e-->
        </div>
    </div>
    <!--卖家留言-s-->
    <div class="customer-messa">
        <div class="maleri30">
            <p>用户备注（50字）</p>
            <textarea class="tapassa" id="user_note" maxlength="50" placeholder="选填"></textarea>
            <span class="xianzd"><em id="zero">50</em>/50</span>
        </div>
    </div>
    <!--订单金额-s-->
    <div class="information_dr ">
        <div class="z-monry">
            <div class="maleri30">
                <div class="p z-monry-cont">
                    <div class="fl">
                        订单优惠
                    </div>
                    <div class="fr">
                        <a> ￥<span id="order_prom_amount">0</span>元</a>
                    </div>
                </div>
                <div class="p z-monry-cont">
                    <div class="fl">
                        商品金额
                    </div>
                    <div class="fr">
                        <a> ￥<span id="total_fee">{$info['wprice']}</span>元</a>
                    </div>
                </div>
                <div class="p z-monry-cont shipping_div">
                    <div class="fl">
                        配送费用
                    </div>
                    <div class="fr">
                        <a> ￥<span id="postFee">0</span>元</a>
                    </div>
                </div>
                <div class="p z-monry-cont">
                    <div class="fl">
                        签到抵扣
                    </div>
                    <div class="fr">
                        <a> ￥<span id="signFee">0</span>元</a>
                    </div>
                </div>
                <div class="p z-monry-cont">
                    <div class="fl">
                        余额抵扣
                    </div>
                    <div class="fr">
                        <a> ￥<span id="balance">0</span>元</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--订单金额 -e-->
    <div id="addressList" style="display: none">
        <!--地址-s-->
        <div class="dizhi-pop">
            <div class="z-Package-hrader">
                <i class="z-Package-icon Package-icon-close" id="address_list_back"></i>
                <h5>选择地址</h5>
            </div>
            <div id="address_list_html" style="height: 19.5rem;overflow:  scroll;">
                <if condition="$address">
                    <volist name="address" id="vo">
                        <div class="jd_listaddless p "> 
                            <div class="maleri30"> 
                                <a class="select_address address_id_{$vo['address_id']}" data-address-id="{$vo['address_id']}" data-mobile="{$vo['mobile']}" data-consignee="{$vo['consignee']}" data-address-area="{$region[$vo['province']]} {$region[$vo['city']]} {$region[$vo['district']]}" data-address="{$vo['address']}" data-province-id="{$vo['province']}"  data-city-id="{$vo['city']}" data-district-id="{$vo['district']}" > 
                                    <div class="name fl"> 
                                        <h1>{$vo['consignee']}</h1> 
                                    </div> 
                                    <div class="numberaddress fl"> 
                                        <span class="number"><i class="number-dh">电话：</i>{$vo['mobile']}</span> 
                                        <span class="similars">{$region[$vo['province']]} {$region[$vo['city']]} {$region[$vo['district']]} {$vo['address']}</span> 
                                    </div> 
                                </a> 
                                <div class="editdiv fl"> 
                                    <a class="address_item"> 
                                        <i class="eedit" onclick="addEditAddress({$vo['address_id']})"></i> 
                                    </a> 
                                </div> 
                            </div> 
                        </div>
                    </volist>
                </if>
            </div>
            <!--地址-e-->
            <div class="createnew ">
                <a id="add_address" onclick="addEditAddress()">+新建地址</a>
            </div>
        </div>
    </div>
    <div id="invoicelist" style="display: none">
        <!--发票内容-s-->
        <div class="dizhi-pop">
            <div class="z-Package-hrader">
                <i class="z-Package-icon Package-icon-close" id="invoice_list_back"></i>
                <h5>发票信息</h5>
            </div>
            <div class="invoice_con">
                <div class="invoice_tit">
                    <h3>发票抬头</h3>
                    <div class="invoice_type">
                        <div class="intype_item"><input type="radio" name="radio_title"  checked id="intype1" value="个人"><label for="intype1"></label><span>个人</span></div>
                        <div class="intype_item"><input type="radio" name="radio_title" id="intype2" value="单位"><label for="intype2"></label><span>单位</span></div>
                    </div>
                </div>
                <hr class="invoice_line">
                <div class="invoice_deta">
                    <h3>发票内容</h3>
                    <div class="invoice_comdel" style="display: none;">
                        <input type="text" id="invoice_title" placeholder="请填写单位名称" value="">
                        <input type="text" id="taxpayer" placeholder="请在此填写纳税人识别号"  value="">
                        <p>开企业抬头发票，请准确填写对应的“纳税人识别号”，以免影响您的发票报销.</p>
                    </div>
                    <div class="invoice_type">
                        <div class="intype_item"><input type="radio" name="radio_cont" checked id="intype3" value="商品明细"><label for="intype3"></label><span>商品明细</span></div>
                        <div class="intype_item"><input type="radio" name="radio_cont" id="intype4" value="商品类别"><label for="intype4"></label><span>商品类别</span></div>
                        <div class="intype_item"><input type="radio" name="radio_cont" id="intype5" value="不开发票"><label for="intype5"></label><span>不开发票</span></div>
                    </div>
                </div>
                <div class="invoice_confir"><input type="button" id="submit_invoice" value="确认"></div>
            </div>
                    </div>
    </div>
    <div id="addressAdd" style="display: none">
        <div class="dizhi-pop">
            <div class="z-Package-hrader">
                <i class="z-Package-icon Package-icon-close" id="address_add_back"></i>
                <h5>新建/编辑地址</h5>
            </div>
            <div class="floor my p edit">
                <form id="address_form">
                    <input type="hidden" value="" data-name="" name="address_id"/>
                    <input type="hidden" value="" data-name="" name="province"/>
                    <input type="hidden" value="" data-name="" name="city"/>
                    <input type="hidden" value="" data-name="" name="district"/>

                    <div class="content">
                        <div class="floor list7">
                            <div class="myorder p">
                                <div class="content30">
                                    <a href="javascript:void(0)">
                                        <div class="order">
                                            <div class="fl">
                                                <span>收货人:</span>
                                            </div>
                                            <div class="fl">
                                                <input type="text" value="" name="consignee"/>
                                                <span class="err" id="err_address_consignee"></span>
                                            </div>
                                        </div>
                                    </a>
                                </div>
                            </div>
                            <div class="myorder p">
                                <div class="content30">
                                    <a href="javascript:void(0)">
                                        <div class="order">
                                            <div class="fl">
                                                <span>手机号码:</span>
                                            </div>
                                            <div class="fl">
                                                <input type="tel" value="" name="mobile" onkeyup="this.value=this.value.replace(/[^\d]/g,'')"/>
                                            </div>
                                        </div>
                                    </a>
                                </div>
                            </div>
                            <div class="myorder p">
                                <div class="content30">
                                    <a href="javascript:void(0)" onclick="location_address(this);">
                                        <div class="order">
                                            <div class="fl">
                                                <span>所在地区: </span>
                                            </div>
                                            <div class="fl">
                                                <span id="area"></span>
                                            </div>
                                            <div class="fr">
                                                <i class="Mright"></i>
                                            </div>
                                        </div>
                                    </a>
                                </div>
                            </div>
                            <div class="myorder p">
                                <div class="content30">
                                    <a href="javascript:void(0)">
                                        <div class="order">
                                            <div class="fl">
                                                <span>详细地址:</span>
                                            </div>
                                            <div class="fl">
                                                <input type="text" value="" name="address"/>
                                            </div>
                                        </div>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="createnew newAjax">
                        <a id="address_form_confirm" onclick="confirm_address()">确认</a>
                    </div>
                </form>
            </div>
            <!--选择地区-s-->
            <div class="container">
                <div class="city">
                    <div class="screen_wi_loc">
                        <div class="classreturn loginsignup">
                            <div class="content">
                                <div class="ds-in-bl return seac_retu">
                                    <a href="javascript:void(0);" onclick="close_location();"><img src="__STATIC__/images/return.png" alt="返回"></a>
                                </div>
                                <div class="ds-in-bl search center">
                                    <span class="sx_jsxz">选择地区</span>
                                </div>
                                <div class="ds-in-bl suce_ok">
                                    <a href="javascript:void(0);">&nbsp;</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="province-list" style="height:27rem;"></div>
                    <div class="city-list" style="height:27rem;display:none"></div>
                    <div class="area-list" style="height:27rem;display:none"></div>
                </div>
            </div>
            <!--选择地区-e-->
            <script type="text/javascript">
                function location_address(){
                    $('.province-list p').remove();
                    $.get("ajaxAreaSelect",function(res){
                        if(res){
                            res = JSON.parse(res);
                            var _html = '';
                            for(var i=0;i<res.length;i++){
                                _html += '<p data-id="'+res[i].id+'" data-last="city" onclick="getlastaddress(this);">'+res[i].name+'</p>';
                                
                            }
                            $('.province-list').append(_html);
                            $('.container').animate({width: '14.4rem', opacity: 'show'}, 'normal',function(){
                                $('.container').show();
                            });
                            if(!$('.container').is(":hidden")){
                                $('body').css('overflow','hidden');
                                $('.mask-filter-div').css('z-index','9999');
                            }
                        }
                    });
                    
                }

                function getlastaddress(obj){
                    var last = $(obj).data('last');
                    var areaid = $(obj).data('id');
                    var areaname = $(obj).html();
                    var downame = '';
                    $(obj).addClass('co_current');
                    if(!last || !areaid || !areaname) return false;
                    if(last == 'city'){
                        var upname = 'province';
                        var downame = 'area';
                    }
                    if(last == 'area'){
                        var upname = 'city';
                        var downame = 'selected';
                    }
                    if(last == 'selected'){
                        var upname = 'district';
                    }
                    $('.'+last+'-list p').remove();
                    $('#address_form input[name='+upname+']').val(areaid);
                    $('#address_form input[name='+upname+']').attr('data-name',areaname);
                    if(downame){
                        $.get("ajaxAreaSelect",{select:last,areaid:areaid},function(res){
                            if(res){
                                res = JSON.parse(res);
                                var _html = '';
                                for(var i=0;i<res.length;i++){
                                    _html += '<p data-id="'+res[i].id+'" data-last="'+downame+'" onclick="getlastaddress(this);">'+res[i].name+'</p>';
                                    
                                }
                                $('.'+last+'-list').append(_html);
                                $('.'+last+'-list').show();
                                $('.'+upname+'-list').hide();
                            }
                        });
                    }else{
                        var province = $('#address_form input[name=province]').attr('data-name');
                        var city = $('#address_form input[name=city]').attr('data-name');
                        var district = $('#address_form input[name=district]').attr('data-name');
                        var address = province + ' ' + city + ' ' + district;
                        $('#area').html(address);
                        $('.area-list').hide();
                        $('.city-list').hide();
                        $('.province-list').show();
                        $('.container').animate({width: '0', opacity: 'show'}, 'normal',function(){
                            $('.container').hide();
                        });
                        $('.mask-filter-div').css('z-index','inherit');
                        $('.area-list').hide();


                    }
                    
                }
                function close_location(){
                    var province_div = $('.province-list');
                    var city_div = $('.city-list');
                    var area_div = $('.area-list');
                    if(area_div.is(":hidden") == false){
                        area_div.hide();
                        city_div.show();
                        province_div.hide();
                        return;
                    }
                    if(city_div.is(":hidden") == false){
                        area_div.hide();
                        city_div.hide();
                        province_div.show();
                        return;
                    }
                    if(province_div.is(":hidden") == false){
                        area_div.hide();
                        city_div.hide();
                        $('.container').animate({width: '0', opacity: 'show'}, 'normal',function(){
                            $('.container').hide();
                        });
                        // undercover();
                        $('.mask-filter-div').css('z-index','inherit');
                        return;
                    }
                }
            </script>
        </div>
    </div>
    <div class="mask-filter-div" style="display: none;"></div>
    <div class="payit fillpay ma-to-20">
        <div class="fr submit_price">
            <a href="javascript:void(0)" onclick="submit_order()">提交订单</a>
        </div>
        <div class="fl">
            <p><span class="pmo">应付金额：</span>￥<span id="payables">{$info['wprice']}</span><span></span></p>
            <input type="hidden" name="hidden-payables" id="hidden-payables" value="{$info['wprice']}">
        </div>
    </div>
</div>
<script type="text/javascript">
    $(document).ready(function () { 
        default_address_id();

    });
    $(function(){
       
        // 使用余额
        $('#user_money').on('change',function(){
            var prop = $('#user_money').prop('checked');
            var user_money = parseFloat($('#user_money').val());
            if(prop){
                var total = parseFloat($('#total_fee').html());
                if(user_money >= total){
                    var balance = user_money - total;
                }else{
                    var balance = total - user_money;
                }
                if(balance > 0){
                    $('#payables').html(0)
                    $('#balance').html(total);
                }else{
                    $('#payables').html(total - user_money);
                    $('#balance').html(user_money);
                }
            }else{
                var price = $('#hidden-payables').val();
                $('#payables').html(price);
                $('#balance').html('0');
            }
        });

        // 选择其他地址
        $('.youjter').on('click',function(){
            $('#addressList').show();
        })
        // 关闭选择地址
        $('#address_list_back').on('click',function(){
            $('#addressList').hide();
        })

        // 选中地址
        $(document).on('click', '.select_address', function () {
            var address_id = $(this).data('address-id');
            var mobile = $(this).data('mobile');
            var consignee = $(this).data('consignee');
            var address_area = $(this).data('address-area');
            var address = $(this).data('address');
            var province_id = $(this).data('province-id');
            var city_id = $(this).data('city-id');
            var district_id = $(this).data('district-id');

            
            $('#input_default_address_id').val(address_id);
            $('#address_selected').attr('item', address_id);
            $('#default_address_consignee').empty().html(consignee);
            $('#default_address_mobile').empty().html(mobile);
            $('#default_address_text').empty().html(address_area + ' ' + address);

            $('#addressList').hide();
        });


        // 关闭 新建/编辑地址
        $('#address_add_back').on('click',function(){
            closeAddEditAddress();
        });

        // 发票
        $('.invoice_title').on('click',function(){
            $('#invoicelist').show();
        });

        // 选择开票身份
        $('.intype_item input[name=radio_title]').on('change',function(){
            var identity = $(this).val();
            if(identity == '个人'){
                $('.invoice_comdel').hide();
            }else{
                $('.invoice_comdel').show();
            }
        })
        // 发票内容
        $('.intype_item input[name=radio_cont]').on('change',function(){
            var type = $(this).val();
            if(type == '不开发票'){
                $('.invoice_comdel').hide();
                $('.invoice_tit').hide();
            }else{
                var identity = $('.intype_item input[name=radio_title]:checked').val();
                if(identity == '单位'){
                    $('.invoice_comdel').show();
                }
                $('.invoice_tit').show();
            }
        })
        // 确认发票信息
        $('#submit_invoice').on('click',function(){
            var identity = $('.intype_item input[name=radio_title]:checked').val();
            var type = $('.intype_item input[name=radio_cont]:checked').val();
            var title = $('#invoice_title').val();
            var code = $('#taxpayer').val();

            $('#hidden-invoice-identity').val(identity);
            $('#hidden-invoice-type').val(type);
            $('#hidden-invoice-title').val(title);
            $('#hidden-invoice-code').val(code);

            if(type == '不开发票'){
                _tpl = '不开发票'
            }else{
                if(identity == '个人'){
                    _tpl = '纸质（个人-'+type+'）';
                }else{
                    if(!title || !code){
                        layer.open({icon: 1, content: "发票抬头不能为空！", time: 2});
                        return false;
                    }else{
                        _tpl = '纸质（'+title+'-'+type+'）';
                    }
                }
            }

            
            $('.invoice_title').html(_tpl);
            $('#invoicelist').hide();
        });
        // 关闭发票内容弹窗
        $('#invoice_list_back').on('click',function(){
            $('#invoicelist').hide();
        });
    });

    // 用户备注字符长度限制
    $('#user_note').on('keyup',function(){
        var user_note = $('#user_note').val();
        var len = parseInt(user_note.length);
        $('#zero').html(50 - len);
        if(len >= 50){
            return false;
        }
    });

    // 提交订单
    function submit_order(){
        var buy_type = $('#hidden-buy-type').val();
        var buy_num = $('#hidden-buy-num').val();
        var team_id = $('#hidden-team-id').val();
        var invoice_type = $('#hidden-invoice-type').val();
        var invoice_identity = $('#hidden-invoice-identity').val();
        var invoice_title = $('#hidden-invoice-title').val();
        var invoice_code = $('#hidden-invoice-code').val();
        var address_id = $('.input_default_address_id').val();
        var user_money = $('#user_money').prop('checked') ? 1 : 0;
        var user_note = $('#user_note').val();

        var data = {
            buy_type:   buy_type,
            buy_num:    buy_num,
            team_id:    team_id,
            invoice_type:   invoice_type,
            invoice_identity:   invoice_identity,
            invoice_title:  invoice_title,
            invoice_code:   invoice_code,
            address_id: address_id,
            user_money: user_money,
            user_note:  user_note
        };
        $.post('falceOrder',{data:data},function(res){
			res = JSON.parse(res);
			if(res.status == 1){
				//layer.open({icon: 1, content: res.msg, time: 2});
				location.href = "/shop/User/login?order_sn=" + res.order_sn;
										
			}else{
				layer.open({icon: 1, content: res.msg, time: 2});
				
			}
        });
        
    }


    function default_address_id(){
        // 默认使用的收货地址ID
        var address_id = $('#address_selected').attr('item');
        $('.input_default_address_id').val(address_id);
    }

    function addEditAddress(address_id = 0){

        if(address_id){
            var data = $('.address_id_'+address_id);
            var mobile = data.data('mobile');
            var consignee = data.data('consignee');
            var address_area = data.data('address-area');
            var address = data.data('address');
            var province_id = data.data('province-id');
            var city_id = data.data('city-id');
            var district_id = data.data('district-id');
            
            $('#address_form input[name=address_id]').val(address_id);
            $('#address_form input[name=province]').val(province_id);
            $('#address_form input[name=district]').val(district_id);

            $('#address_form input[name=consignee]').val(consignee);
            $('#address_form input[name=mobile]').val(mobile);
            $('#address_form #area').html(address_area);
            $('#address_form input[name=address]').val(address);

        }

        $('#addressAdd').show();

    }

    function confirm_address(){
        var address_id = $('#address_form input[name=address_id]').val();
        var province = $('#address_form input[name=province]').val();
        var city = $('#address_form input[name=city]').val();
        var district = $('#address_form input[name=district]').val();
        
        var consignee = $('#address_form input[name=consignee]').val();
        var mobile = $('#address_form input[name=mobile]').val();
        var area = $('#address_form #area').html();
        var address = $('#address_form input[name=address]').val();
        
        $.post("addEditAddress",{
            address_id: address_id,
            province: province,
            city: city,
            district: district,
            consignee: consignee,
            mobile: mobile,
            area: area,
            address: address
        },function(res){
            if(res){
                res = JSON.parse(res);
                if(res.status == 1){
                    if(!address_id){
                        nwesAddress(res.id,mobile,consignee,area,address,province,city,district,0);
                    }else{
                        nwesAddress(res.id,mobile,consignee,area,address,province,city,district,1);
                    }
                    closeAddEditAddress();
                }else{
                    layer.open({icon: 1, content: res.msg, time: 2});
                }
            }
        });
    }


    function closeAddEditAddress(){
        $('#addressAdd').hide();
        $('#address_form').find(':input').val('');
        $('#address_form #area').html('');
    }

    function nwesAddress(id,mobile,consignee,area,address,province,city,district,del=0){
        var _html = ''+
        '<div class="jd_listaddless p "> '+
        '<div class="maleri30">'+
            '<a class="select_address address_id_'+id+'" data-address-id="'+id+'" data-mobile="'+mobile+'" data-consignee="'+consignee+'" data-address-area="'+area+'" data-address="'+address+'" data-province-id="'+province+'"  data-city-id="'+city+'" data-district-id="'+district+'" > '+
                '<div class="name fl"> '+
                    '<h1>'+consignee+'</h1>'+
                '</div> '+
                '<div class="numberaddress fl"> '+
                    '<span class="number"><i class="number-dh">电话：</i>'+mobile+'</span> '+
                    '<span class="similars">'+area+' '+address+'</span> '+
                '</div> '+
            '</a> '+
            '<div class="editdiv fl"> '+
                '<a class="address_item"> '+
                    '<i class="eedit" onclick="addEditAddress('+id+')"></i> '+
                '</a> '+
            '</div> '+
        '</div> '+
        '</div>';
        if(del){
            $('.address_id_'+id).parents('.jd_listaddless').remove();
        }
        $('#address_list_html').append(_html);
    }
</script>